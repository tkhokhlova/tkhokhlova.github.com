\chapter{Теоретические основания для~диагностирования устойчивости нейронных сетей: конус устойчивости}
\label{chapter1:theoretical_background_stabcone} 


\section{Нейронные сети и дифференциальные уравнения с~запаздываниями}
\label{sec:neural_nets_and_dif_eqs}

Одна из самых популярных моделей искусственных нейронных сетей описывается 
дифференциальными уравнениями вида
\begin{equation}\label{nonlinearmodel}
    C_j\dot{x}_j(t)+\frac{1}{R_j}x_j(t)+\sum_{k=1}^n T_{jk}g_k ((x_k(t))=0, 
    \quad j=1,2,\ldots,n.     
\end{equation}
Здесь~$n\geqslant 2$ есть количество нейронов в~сети, $x_j$~--- сигнал,  
$C_j$ и $R_j>0$~--- входные ёмкости и сопротивления соответственно $j$-го~нейрона.   
Матрица~$T_{jk}$ размера~$n\times n$ представляет мощность связи между нейронами. 
Если $T_{jk}>0$, то положительный выходной сигнал $k$-го нейрона работает 
на~торможение  $j$-го~нейрона, если $T_{jk}<0$, то на~возбуждение, 
если $T_{jk}=0$, то связь между $k$-м и $j$-м~нейронами отсутствует.   
Гладкие функции~$g_j$ являются функциями активации. 
Модель~\eqref{nonlinearmodel} предложена Хопфилдом~\cite{Hopfield_1984} в~1984\,г. 
и с~тех~пор стала называться моделью Хопфилда. Сам Хопфилд заметил, 
что в переключениях нейронов имеются запаздывания. 
В~модель Хопфилда запаздывания впервые ввели Маркус и Вестервельт в~1989\,г.~\cite{Marcus&Westervelt_1989}.   
Они рассмотрели модель вида 
\begin{equation}\label{delayednonlinearmodel}
    C_j\dot{x}_j(t)+\frac{1}{R_j}x_j(t)+\sum_{k=1}^n T_{jk}g_k ((x_k(t-\tau))=0 , 
    \quad j=1,2,\ldots,n,     
\end{equation}
где $\tau$~--- запаздывание. 

Во~многих работах рассматривается сети, в~которых $C_j=\rm{const}$, $R_j \hm{=} \rm{const}$, 
и в~таких случаях, изменяя масштаб времени, мы можем считать, что $C_j=R_j=1$. 
Часто рассматриваются функции $g_j(x)$ <<сигмо\-ид\-но\-го вида>>. 
В~нескольких  работах (например, \cite{Gopalsami&Leung_1996,Wei&Ruan_1999,Yu&Cao_2007}) 
изучается система из двух нейронов вида  
\begin{equation}\label{secondorderdelayednonlinearmodel}
    \begin{array}{l}
        \dot{x}_1(t)+x_1(t) + T_{12}\th(x_2(t-\tau_2))=0,\\ 
        \dot{x}_2(t)+x_2(t) + T_{21}\th(x_1(t-\tau_1))=0.
    \end{array}
\end{equation}
В~работе К.\,Гопалсами и И.\,Леунга~\cite{Gopalsami&Leung_1996} 
рассматривается модель~\eqref{secondorderdelayednonlinearmodel} с~$\tau_1=\tau_2$.


В дальнейшем выяснилось, что для большей адекватности модели естественно ввести 
различные запаздывания в~\eqref{delayednonlinearmodel} и рассматривать модели вида 
\begin{equation}\label{multipledelayednonlinearmodel}
    C_j\dot{x}_j(t)+\frac{1}{R_j}u_j(t)+\sum_{k=1}^n T_{jk}g_k ((x_k(t-\tau_{jk}))=0, 
    \quad j=1,2,\ldots,n, 
\end{equation}
Известны трудности изучения устойчивости дифференциальных уравнений  
с~двумя запаздываниями даже в скалярном случае, 
выявленные М.\,Кипнисом и И.\,Левицкой~\cite{Levitskaya_2006,Kipnis&Levitskaya_2007}. 
По~этой причине в~большинстве исследований часть запаздываний~$\tau_{jk}$, 
которые  либо в~точности равны нулю, либо близки к~нулю,  
переводят из~последнего  слагаемого в~левой части~\eqref{multipledelayednonlinearmodel} 
во~второе слагаемое, а~остальные запаздывания отождествляют, 
и мы от~\eqref{multipledelayednonlinearmodel} переходим к~уравнению 
\begin{equation}\label{complexmultipledelayednonlinearmodel}
    \dot{x}_j(t)+\sum_{k=1}^n  a_{jk}x_k(t)+\sum_{k=1}^n T_{jk}g_k ((x_k(t-\tau))=0, 
    \quad j=1,2,\ldots,n, 
\end{equation}
где~$a_{jk}$ коэффициенты, характеризующие мощность мгновенного взаимодействия между нейронами. 
Наконец, линеаризация уравнения~\eqref{complexmultipledelayednonlinearmodel} 
вокруг стационарного состояния приводит нас к~матричному уравнению
\begin{equation}\label{maineqmatrix}
    \dot{x}(t)+A x(t)+B x(t-\tau)=0, 
\end{equation}
где~$n\times n$ матрица~$A$ есть матрица мгновенных взаимодействий, а~$n\times n$ 
матрица~$B$~--- матрица взаимодействий с~запаздыванием.  
 
Уравнение~\eqref{maineqmatrix} будет основным в~нашем исследовании. 
Оно подвергалось изучению также в~связи с~задачами устойчивости систем автоматического управления, 
например, В.\,Харитоновым, К.\,Гу и Дж.\,Ченом~\cite{Gu&Khar_2003} и Мори 
с~соавторами~\cite{Mori&Fukuma&Kuwahara_1981,Mori&Kokame_1989}.  
 
Вопрос о~глобальной устойчивости стационарных состояний нейронных сетей 
иногда ставится и при некоторых условиях решается (например, в~работах 
ван~дер~Дрише~\cite{Dreissche_1998}, Л.\,Идельса и М.\,Кипниса~\cite{Idels&Kipnis_2009}).
Но в~зависимости от~назначения нейронной сети в~ней может быть одно или несколько 
стационарных состояний. Например, если сеть служит в~качестве хранилища памяти, 
то число состояний каждого нейрона больше единицы, а~число состояний всей сети, 
разумеется, растёт экспоненциально в~зависимости от числа нейронов. 

Поэтому  глобальная устойчивость нейронной сети  иногда  нежелательна. 
Но локальная устойчивость, по"=видимому, является положительным свойством любой 
нейронной сети. Именно локальная устойчивость стационарных состояний нейронных сетей  
является предметом диссертационного исследования. 

Специфика нейронных сетей в~том, что они составляются из однотипных нейронов. 
Поэтому в~отличие от общей теории устойчивости систем управления в исследованиях 
по нейронным сетям изучаются уравнения~\eqref{maineqmatrix} со~специфическими  
матрицами~$A,\,B$. Следующие примеры прояснят некоторые особенности  описания 
моделей нейронных сетей.


\begin{example}\label{example:neural_net2x3} 
Рассмотрим систему из шести нейронов, связи которых указаны на рисунке~\ref{fig:2x3neurons}.   
\begin{figure}[ht]
    \centering
    \subfloat{\includegraphics[width=5cm]{grid_of_neurons}}
    \caption{%
        Граф связей в нейронной сети}
    \label{fig:2x3neurons}
\end{figure}
Положим, все связи между различными нейронами имеют запаздывание~$\tau$. 
Пусть мощность взаимодействия каждого нейрона с~левым  соседом равна~$a$, 
с~правым~--- $b$, с~верхним~--- $c$,  с~нижним~--- $d$. 
Положим, реакция каждого нейрона на~свой собственный сигнал мгновенна. 
Тогда сеть на рисунке~\ref{fig:2x3neurons} описывается уравнением~\eqref{maineqmatrix} 
с~вектор-функцией $x=(x_{11},  x_{12},  x_{13}, x_{21}, x_{22}, x_{23})^T$ с~матрицами
 \begin{equation}\label{matr_for_2x3}
        A=E,  \qquad
        B= 
        \begin{pmatrix}
            0&b&0&d&0&0\\[-3mm]
            a&0&b&0&d&0\\[-3mm]
            0&a&0&0&0&d\\[-3mm]
            c&0&0&0&b&0\\[-3mm]
            0&c&0&a&0&b\\[-3mm]
            0&0&c&0&a&0\\
        \end{pmatrix}.
 \end{equation}
%Здесь $b$ есть мощность запаздывающего взаимодействия между нейронами.
\end{example}

\begin{example}\label{example:ones_more_neural_net2x3}      
Рассмотрим  вариант интерпретации системы связей  на~рисунке~\ref{fig:2x3neurons}) 
как двуслойной сети. Будем считать, что первый слой состоит из~нейронов $11$, $12$, $13$, 
второй слой из~$21$, $22$, $23$. Пусть взаимодействие нейронов внутри слоев происходит 
без~запаздывания, а взаимодействие нейронов из~разных слоев происходит 
с~запаздыванием~$\tau$. Положим, мощности взаимодействия таковы, как они описаны 
в~предыдущем примере.

Усложняя сеть, положим также, что каждый нейрон, кроме мгновенной реакции 
на~собственное состояние, реагирует на~собственное состояние ещё~и с~запаздыванием  
с~некоторой мощностью~$e$ (такие реакции нейронов рассматривались 
С.\,Гуо и Л.\,Хуангом~\cite{Guo&Huang_2007}, а~также С.\,Кемпбелл 
с~соавторами~\cite{Campbell&Ruan&Wei_1999,Yuan&Campbell_2004}).

Тогда нейронная сеть описывается уравнением~\eqref{maineqmatrix} с~матрицами
\begin{equation}\label{once_more_matr_for_2x3}
    A=\begin{pmatrix}
        1&b&0&0&0&0\\[-3mm]
        a&1&b&0&0&0\\[-3mm]
        0&a&1&0&0&0\\[-3mm]
        0&0&0&1&b&0\\[-3mm]
        0&0&0&a&1&b\\[-3mm]
        0&0&0&0&a&1\\
    \end{pmatrix},
      \qquad
    B= 
    \begin{pmatrix}
        e&0&0&d&0&0\\[-3mm]
        0&e&0&0&d&0\\[-3mm]
        0&0&e&0&0&d\\[-3mm]
        c&0&0&e&0&0\\[-3mm]
        0&c&0&0&e&0\\[-3mm]
        0&0&c&0&0&e\\
    \end{pmatrix}.
\end{equation}
\end{example}    

Примеры демонстрируют, что  в~описании нейронных сетей часто фигурируют 
симметричные матрицы, а~также блочные матрицы  относительно несложной структуры. 
Ещё одна особенность матриц, часто встречающаяся  в~уравнениях нейронных сетей~--- 
ненулевыми элементами заполняются только немногие диагонали над и под главной 
диагональю, то~есть матрицы являются ленточными. Это связано с~тем, что 
во~многих (но не~всех) сетях нейроны соединяются только с~ближайшими в~некотором 
смысле соседями, то~есть наблюдается близкодействие. Как покажут следующие главы 
диссертации, существенной особенностью исследуемых в диссертации задач устойчивости 
нейронных сетей является зависимость устойчивости только от~согласованного спектра 
двух матриц~$A,\,B$  в~случае их одновременного приведения к~треугольной форме.

Дадим~обзор содержания остальных  разделов главы~\ref{chapter1:theoretical_background_stabcone}. 
Достаточные признаки устойчивости матричного уравнения~\eqref{maineqmatrix}
даны в~\cite{Gu&Khar_2003,Kiryanen_1994,Kiryanen&Gal_1989,Mori&Fukuma&Kuwahara_1981,Mori&Kokame_1989,Wang_1992}.
В~\cite{Matsunaga_2009} исследуется эта задача для матриц~$2\times 2$
специального вида. В~следующих разделах главы~\ref{chapter1:theoretical_background_stabcone}     
диссертации мы даем метод, позволяющий дать полный геометрический обзор 
тех значений  запаздывания~$\tau$, которые обеспечивают устойчивость уравнения~\eqref{maineqmatrix}. 
Метод пригоден для уравнений с~матрицами~$A,B$, которые могут быть приведены 
одной трансформирующей матрицей к~треугольному виду.  Это в~точности класс матриц~$A,B$, 
таких что $AB-BA$ нильпотентна~\cite{Horn&Johnson_1986}. Этот класс включает все 
коммутирующие пары матриц~$A,B$. 

Несмотря на указанные ограничения,  этот метод  даёт возможность изучать 
устойчивость широких классов нейронных сетей: сетей кольцевой и линейной архитектуры, 
сетей, описываемых двудольными графами, трёхслойных сетей, так~как все вышеуказанные 
сети описываются уравнениями вида~\eqref{maineqmatrix}  с~одновременно 
триангулируемыми матрицами. В~примерах~\ref{example:neural_net2x3},
\ref{example:ones_more_neural_net2x3} матрицы~$A\, ,B$ коммутируют.

Этот метод основан на конусе устойчивости~--- некоторой  поверхности 
в~$\mathbb{R}^3$, одной для класса всех уравнений вида~\eqref{maineqmatrix}, 
в~которых  матрицы~$A,B$ одновременно приводимы к~треугольному виду. 
Конус устойчивости впервые был~введён в~работе автора~\cite{Khokhlova&Kipnis&Malygina_2011} 
совместно с~научным руководителем и В.\,В.~Малыгиной.  
Идейно конус устойчивости происходит от~давней работы З.\,Рехлицкого~\cite{Rekhlitskiy_1956} (1956), 
в~которой был~построен овал устойчивости для~некоторого общего уравнения 
вида~\eqref{maineqmatrix} с~$A=0$.

В~этой главе конус устойчивости будет~введён постепенно. Вначале вводятся 
овалы устойчивости для~скалярного уравнения вида~\eqref{maineqmatrix} 
с~действительным коэффициентом~$A$ и комплексным~$B$ (раздел~\ref{sec:stability_oval}), 
затем конус устойчивости для~скалярного  уравнения с~комплексными коэффициентами 
(раздел~\ref{sec:stability_cone_definition}), который будет~работать также и 
для~матричного уравнения~\eqref{maineqmatrix}.В~основном 
разделе~\ref{sec:stability_cone_for_matrix_equ} доказывается теорема о~конусе  
устойчивости для матричного уравнения~\eqref{maineqmatrix}, которая будет 
теоретической основой для~алгоритмов диагностирования устойчивости нейронных сетей 
и их программных реализаций. 

Особняком стоит раздел~\ref{sec:inequalities_for_cone} о~системе неравенств 
для~диагностики устойчивости  этого~же уравнения. Он не~будет использоваться далее 
в~диссертации.

В последнем разделе результаты  главы  \ref{chapter1:theoretical_background_stabcone} сравниваются   с известными результатами.  
